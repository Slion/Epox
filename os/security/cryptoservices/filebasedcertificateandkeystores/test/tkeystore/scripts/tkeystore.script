//
// Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
// All rights reserved.
// This component and the accompanying materials are made available
// under the terms of the License "Eclipse Public License v1.0"
// which accompanies this distribution, and is available
// at the URL "http://www.eclipse.org/legal/epl-v10.html".
//
// Initial Contributors:
// Nokia Corporation - initial contribution.
//
// Contributors:
//
// Description: 
//

START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0001

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0001

//! @SYMTestCaseDesc          //////////////////////////////////////////////////////////////////////////////////

//!                           Adding a key

//!                           //////////////////////////////////////////////////////////////////////////////////

//!                           The action name now bears, when relevant, the TEST ID which will help map the

//!                           resulting log to the DLRs, a mapping of these (TEST IDs to REQ number) can be found in

//!                           "V:\Dev\GT\GT 0140 Security\Test and Integration\Test Specifications\DLR mappings\keystore.xls"

//! @SYMTestActions           1) Delete keystore data file

//!                           2) Retrieving label of a particular key store

//!                           3) Closing key store

//!                           4) Retrieving label of a particular key store

//!                           5) Closing key store

//!                           6) 1.0.0.0.1,Opening key store 1 in manager mode - deprecated

//!                           7) 1.0.0.0.2,Opening key store 2 in manager mode

//!                           8) 1.0.0.1 NOT A TEST Delete default keys

//!                           9) 1.0.0.1.0,Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           10) 1.0.0.1.1,List all keys (TEST ID: INC103084-KEY001)

//!                           11) 1.0.0.1.0.0,export a DH key

//!                           12) 1.0.0.1,Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           13) 1.0.0.1.1,Set passphrase timeout to "don't cache"

//!                           14) 1.0.0.2,Get it again

//!                           15) 1.0.0.2.1,Open it

//!                           16) 1.0.0.2.2,Open a banana for decrypt

//!                           17) Changing password - All wrong tries

//!                           18) Changing password - First two wrong tries, third correct passphrase

//!                           19) Changing password - First wrong try, in second try correct passphrase used

//!                           20) Changing password - In first try correct passphrase used

//!                           21) Decrypt

//!                           22) 1.0.0.2.2.1, Sign with a banana, 20 char text

//!                           23) 1.0.0.2.2.2, Sign with a banana, 32 char text

//!                           24) 1.0.0.2.2.2.1, Sign digest with a banana

//!                           25) 1.0.0.2.2.3, Sign digest with a banana, text too large

//!                           26) 1.0.0.2.3,Open a banana as a DSA key

//!                           27) 1.0.0.2.4,Open a banana as a DH key

RUN_TEST_STEP                 -1    CTestHandler        deletekeystoredata  

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-002

RUN_TEST_STEP                 -1    CTestHandler        delete              

RUN_TEST_STEP !Error=-2       -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-004

RUN_TEST_STEP                 -1    CTestHandler        delete              

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-007

RUN_TEST_STEP                 -1    CTestHandler        deletekeys          

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-009

RUN_TEST_STEP                 -1    CTestHandler        listallkeys            tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-010

RUN_TEST_STEP !Error=-5       -1    CTestHandler        exportkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-011

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-012

RUN_TEST_STEP                 -1    CTestHandler        settimeout             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-013

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-014

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-015

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-016

RUN_TEST_STEP !Error=-11000   -1    CTestHandler        changepassphrase       tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-017

RUN_TEST_STEP                 -1    CTestHandler        changepassphrase       tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-018

RUN_TEST_STEP                 -1    CTestHandler        changepassphrase       tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-019

RUN_TEST_STEP                 -1    CTestHandler        changepassphrase       tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-020

RUN_TEST_STEP                 -1    CTestHandler        decrypt                tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-021

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-022

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-023

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-024

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-025

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-026

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0001-027

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0001





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0002

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0002

//! @SYMTestCaseDesc          Try to add a key that is already there - should fail with KErrAlreadyExists

//! @SYMTestActions           1) 1.0.0.3,Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

RUN_TEST_STEP !Error=-11      -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0002-001

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0002





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0003

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0003

//! @SYMTestCaseDesc          Add a key with an unsupported algorithm

//! @SYMTestActions           1) 1.0.0.4,Add a key with an unsupported algorithm (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           2) 1.0.0.5,Add a key with a very long label (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           3) 1.0.0.6,Get that key again

//!                           4) 1.0.0.6.1,Open that key again

//!                           5) 1.0.0.6.2 Sign long key

//!                           6) 1.0.0.7,Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           7) 1.0.0.8,Check getting it again

//!                           8) 1.0.0.9,Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           9) 1.0.0.10,Get it again

//!                           10) 1.0.0.10.1, Sign with a carrot, 20 char text

//!                           11) 1.0.0.10.2, Sign with carrot, text too long (21 chars)

//!                           12) 1.0.0.10.2, Sign digest with carrot

//!                           13) 1.0.0.10.3, Sign digest with a carrot, fail hash

//!                           14) 1.0.0.10.4,Add a key

//!                           15) 1.0.0.10.5,Get it again

//!                           16) 1.0.0.10.6, Sign with a artichoke, 20 char text

//!                           17) 1.0.0.10.7, Sign with artichoke, text too long (21 chars)

//!                           18) 1.0.0.10.7, Sign digest with artichoke

//!                           19) 1.0.0.10.8, Sign digest with artichoke, fail hash

//!                           20) 1.0.0.11,Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           21) 1.0.0.12,Get key info

//!                           22) 1.0.0.12.1,Open it

//!                           23) 1.0.0.12.2, Test derive

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-001

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-002

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-003

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-004

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-005

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-006

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-007

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-008

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-009

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-010

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-011

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-012

RUN_TEST_STEP !Error=-2       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-013

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-014

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-015

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-016

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-017

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-018

RUN_TEST_STEP !Error=-2       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-019

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-020

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-021

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-022

RUN_TEST_STEP                 -1    CTestHandler        derive                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0003-023

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0003





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0004

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0004

//! @SYMTestCaseDesc          test added for combined NR and Sign usage

//! @SYMTestActions           1) 1.0.0.12.0.0,Add a key with legal usage

//!                           2) 1.0.0.13,Add a key with illegal usage (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           3) 1.0.0.14,Add a key with illegal usage (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           4) 1.0.0.15,Add a key with illegal usage (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           5) 1.0.0.16,Add a key with illegal usage (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           6) 1.0.0.17,Add a key with an unacceptably short length (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           7) 1.0.0.18,Add a key with an unacceptably long length (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           8) 1.0.0.19,Add a long key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           9) 1.0.0.19.1, Sign with a guava, 20 char text

//!                           10) 1.0.0.19.2, Sign with a guava, 32 char text

//!                           11) 1.0.0.19.2, Sign digest with a guava

//!                           12) 1.0.0.2.2.3, Sign digest with a guava, text too large

//!                           13) 1.0.0.20,Add a strangely-lengthed key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           14) 1.0.0.21.1,Open it

//!                           15) 1.0.0.21,Get key info

//!                           16) 1.0.0.22 List everything (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           17) 1.0.0.23 List DSA keys (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           18) 1.0.0.24 List Sign-usage keys (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           19) 1.0.0.25 List 'All usages' keys (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           20) 1.0.0.26, Delete RSA keys (TEST ID: GT0140KEY004)

//!                           21) 1.0.0.27 List RSA keys (TEST ID: GT0140-KEY001)

//!                           22) 1.0.0.28 List everything (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           23) 1.0.0.29, Add a key that was previously deleted (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           24) 1.0.0.30 List RSA keys (TEST ID: GT0140-KEY001)

//!                           25) 1.0.0.31 List everything (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           26) 1.0.0.32, Delete it again (TEST ID: GT0140KEY004)

//!                           27) 1.0.0.33, Try to delete a non existent key (TEST ID: GT0140KEY004)

//!                           28) 1.0.0.34, Try to delete a non existent key (TEST ID: GT0140KEY004)

//!                           29) 1.0.0.35, Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           30) 1.0.0.36, Get key info

//!                           31) 1.0.0.37, Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           32) 1.0.0.38, Get the key

//!                           33) 1.0.0.39, Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           34) 1.0.0.40, Get key info

//!                           35) 1.0.0.40.1, Sign with a cauliflower, 20 char text

//!                           36) 1.0.0.40.2, Sign with a cauliflower, 32 char text

//!                           37) 1.0.0.40.2, Sign digest with a cauliflower

//!                           38) 1.0.0.40.3, Sign digest with a cauliflower, text too large

//!                           39) 1.0.0.41, Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           40) 1.0.0.42, Get key info

//!                           41) 1.0.0.43, Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           42) 1.0.0.44, Get it

//!                           43) 1.0.0.45, Add a key (TEST ID: GT0140-KEY002 and GT0140-KEY003)

//!                           44) 1.0.0.46, Get key info

//!                           45) 1.0.0.47 List everything (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           46) 1.0.0.48 List RSA keys (TEST ID: GT0140-KEY001)

//!                           47) 1.0.0.49 List DSA keys (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           48) 1.0.0.50, Get a carrot

//!                           49) 1.0.0.51 Import a RSA key

//!                           50) 1.0.0.51.1, Get it again

//!                           51) 1.0.0.51.2, Sign with an imported banana, 20 char text

//!                           52) 1.0.0.51.3, Sign with a *IMPORTED*banana, 32 char text

//!                           53) 1.0.0.51.3, Sign digest with a *IMPORTED*banana

//!                           54) 1.0.0.51.4, Sign digest with a *IMPORTED*banana, text too large

//!                           55) 1.0.0.52 Import a RSA key

//!                           56) 1.0.0.52.1, Get it again

//!                           57) 1.0.0.53 Import a RSA key

//!                           58) 1.0.0.54, Get it again

//!                           59) 1.0.0.54.1 Import a RSA key

//!                           60) 1.0.0.54.2, Get it again

//!                           61) 1.0.0.54.3, Sign with a *IMPORTED*coconut, 20 char text

//!                           62) 1.0.0.54.4, Sign with a *IMPORTED*coconut, 32 char text

//!                           63) 1.0.0.54.4, Sign digest with a *IMPORTED*coconut

//!                           64) 1.0.0.54.5, Sign digest with a *IMPORTED*coconut, text too large

//!                           65) 1.0.0.55 Import a RSA key

//!                           66) 1.0.0.55.1, Get it again

//!                           67) 1.0.0.55.2, Sign with a *IMPORTED*mango, 20 char text

//!                           68) 1.0.0.55.3, Sign with a *IMPORTED*mango, 32 char text

//!                           69) 1.0.0.55.3, Sign digest with a *IMPORTED*mango

//!                           70) 1.0.0.55.4, Sign digest with a *IMPORTED*mango, text too large

//!                           71) 1.0.0.56 Try to import an invalid length RSA key

//!                           72) 1.0.0.57 Import a DSA key

//!                           73) 1.0.0.58 Import a DSA key

//!                           74) 1.0.0.59 Import a DSA key

//!                           75) 1.0.0.60 Import a DSA key

//!                           76) 1.0.0.61 Import a DSA key

//!                           77) 1.0.0.62 Try to import an invalid length DSA key

//!                           78) 1.0.0.63 List everything (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           79) 1.0.0.64 List RSA keys (TEST ID: GT0140-KEY001)

//!                           80) 1.0.0.65 List DSA keys (TEST ID: GT0140-KEY001) (including illegal usage keys)

//!                           81) 1.0.0.66 Get a nonexistent key

//!                           82) 1.0.0.67 Delete everything (TEST ID: GT0140KEY004)

//!                           83) 1.1.0.4 Import a RSA key

//!                           84) 1.1.0.5 Import a RSA key

//!                           85) 1.1.0.6 Import a RSA key

//!                           86) 1.1.0.7 Import a RSA key

//!                           87) 1.1.0.8 Import a RSA key

//!                           88) 1.1.0.9 Try to import an invalid length RSA key

//!                           89) 1.1.0.10 Import a DSA key

//!                           90) 1.1.0.11 Import a DSA key

//!                           91) 1.1.0.12 Import a DSA key

//!                           92) 1.1.0.13 Import a DSA key

//!                           93) 1.1.0.14 Import a DSA key

//!                           94) 1.1.0.15 Try to import an invalid length DSA key

//!                           95) 1.1.0.16 List everything (TEST ID: GT0140-KEY001)

//!                           96) 1.1.0.17 List RSA keys (TEST ID: GT0140-KEY001)

//!                           97) 1.1.0.18 List DSA keys (TEST ID: GT0140-KEY001)

//!                           98) 1.1.0.19 Import a PKCS5 encrypted RSA key

//!                           99) 1.1.0.19.1 Import a PKCS5 encrypted RSA key with the wrong password

//!                           100) 1.1.0.20 Import a PKCS5 encrypted RSA key

//!                           101) 1.1.0.21 Import a PKCS5 encrypted RSA key

//!                           102) 1.1.0.22 Import a PKCS5 encrypted RSA key

//!                           103) 1.1.0.23 Import a PKCS5 encrypted RSA key

//!                           104) 1.1.0.24 List RSA keys (TEST ID: GT0140-KEY001)

//!                           105) 1.1.0.25 Import a PKCS5 encrypted DSA key

//!                           106) 1.1.0.26 Import a PKCS5 encrypted DSA key

//!                           107) 1.1.0.27 Import a PKCS5 encrypted DSA key

//!                           108) 1.1.0.28 Import a PKCS5 encrypted DSA key

//!                           109) 1.1.0.29 Import a PKCS5 encrypted DSA key

//!                           110) 1.1.0.29.1 List DSA keys (TEST ID: GT0140-KEY001)

//!                           111) 1.1.0.29.2 Try to import invalid data (PKCS5 encrypted RSA key, not PKCS8)

//!                           112) 1.1.0.29.4 Try to import invalid data (garbage)

//!                           113) 1.1.0.33 List RSA keys (TEST ID: GT0140-KEY001)

//!                           114) 1.2, Delete everything (TEST ID: GT0140KEY004)

//!                           115) 1.2.0.68 List everything (TEST ID: GT0140-KEY001)

//!                           116) 1.2.0.69.0 Closing key store 1 - deprecated

//!                           117) 1.2.0.69.1 Closing key store 2

//!                           118) 1.3.2.1,Opening a key store in user mode

//!                           119) 1.3.2.2,Closing key store

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-001

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-002

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-003

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-004

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-005

RUN_TEST_STEP !Error=-11009   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-006

RUN_TEST_STEP !Error=-11009   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-007

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-008

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-009

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-010

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-011

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-012

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-013

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-014

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-015

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-016

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-017

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-018

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-019

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-020

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-021

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-022

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-023

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-024

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-025

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-026

RUN_TEST_STEP !Error=-1       -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-027

RUN_TEST_STEP !Error=-1       -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-028

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-029

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-030

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-031

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-032

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-033

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-034

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-035

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-036

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-037

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-038

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-039

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-040

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-041

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-042

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-043

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-044

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-045

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-046

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-047

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-048

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-049

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-050

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-051

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-052

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-053

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-054

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-055

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-056

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-057

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-058

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-059

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-060

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-061

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-062

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-063

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-064

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-065

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-066

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-067

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-068

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-069

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-070

RUN_TEST_STEP !Error=-11009   -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-071

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-072

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-073

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-074

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-075

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-076

RUN_TEST_STEP !Error=-11009   -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-077

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-078

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-079

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-080

RUN_TEST_STEP !Error=-1       -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-081

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-082

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-083

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-084

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-085

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-086

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-087

RUN_TEST_STEP !Error=-11009   -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-088

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-089

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-090

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-091

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-092

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-093

RUN_TEST_STEP !Error=-11009   -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-094

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-095

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-096

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-097

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-098

RUN_TEST_STEP !Error=-6       -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-099

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-100

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-101

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-102

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-103

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-104

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-105

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-106

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-107

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-108

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-109

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-110

RUN_TEST_STEP !Error=-6       -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-111

RUN_TEST_STEP !Error=-6       -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-112

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-113

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-114

RUN_TEST_STEP                 -1    CTestHandler        listkeys               tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-115

RUN_TEST_STEP                 -1    CTestHandler        delete              

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0004-118

RUN_TEST_STEP                 -1    CTestHandler        delete              

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0004





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0005

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0005

//! @SYMTestCaseDesc          //////////////////////////////////////////////////////////////////////////////////

//!                           Opening Unfied Key Store first in user mode, then in manager mode

//!                           //////////////////////////////////////////////////////////////////////////////////

//! @SYMTestActions           1) 1.3.3.1,Opening a key store in user mode

//!                           2) 1.3.3.2,Opening key store again in manager mode

//!                           3) 1.3.3.3,Closing key store

//!                           4) 1.3.3.3.1,Closing key store

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0005-001

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0005-002

RUN_TEST_STEP                 -1    CTestHandler        delete              

RUN_TEST_STEP                 -1    CTestHandler        delete              

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0005





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0006

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0006

//! @SYMTestCaseDesc          //////////////////////////////////////////////////////////////////////////////////

//!                           Opening Unified Key Store first in manager mode, then in user mode

//!                           //////////////////////////////////////////////////////////////////////////////////

//! @SYMTestActions           1) 1.3.4.1,Opening a key store in manager mode

//!                           2) 1.3.4.2,Opening key store again in user mode

//!                           3) 1.3.4.3,Closing key store

//!                           4) 1.3.4.3.1,Closing key store

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0006-001

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0006-002

RUN_TEST_STEP                 -1    CTestHandler        delete              

RUN_TEST_STEP                 -1    CTestHandler        delete              

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0006





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0007

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0007

//! @SYMTestCaseDesc          //////////////////////////////////////////////////////////////////////////////////

//! @SYMTestActions           1) 1.4.0,Opening key store in manager mode

RUN_TEST_STEP                 -1    CTestHandler        init                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0007-001

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0007





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0008

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0008

//! @SYMTestCaseDesc          1.4.1 Test key usage

//!                           

//!                           1.4.1.1. Test keys with no usage

//! @SYMTestActions           1) 1.4.1.1.1, Add key (usage: none)

//!                           2) 1.4.1.1.2, Set passphrase timeout to "don't cache"

//!                           3) 1.4.1.1.3, Check info

//!                           4) 1.4.1.1.4, Sign, expect failure

//!                           5) 1.4.1.1.5, Decrypt, expect failure

//!                           6) 1.4.1.1.6, Derive, expect failure

//!                           7) 1.4.1.1.7, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0008-001

RUN_TEST_STEP                 -1    CTestHandler        settimeout             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0008-002

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0008-003

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0008-004

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0008-005

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0008-006

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0008-007

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0008





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0009

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0009

//! @SYMTestCaseDesc          1.4.1.2. Test keys with sign usage only

//! @SYMTestActions           1) 1.4.1.2.1, Add key

//!                           2) 1.4.1.2.2, Check info

//!                           3) 1.4.1.2.3, Sign, expect success

//!                           4) 1.4.1.2.4, Decrypt, expect failure

//!                           5) 1.4.1.2.5, Derive, expect failure

//!                           6) 1.4.1.2.6, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0009-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0009-002

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0009-003

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0009-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0009-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0009-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0009





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0010

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0010

//! @SYMTestCaseDesc          1.4.1.3. Test keys with signRecover usage only

//! @SYMTestActions           1) 1.4.1.3.1, Add key

//!                           2) 1.4.1.3.2, Check info

//!                           3) 1.4.1.3.3, Sign, expect success

//!                           4) 1.4.1.3.4, Decrypt, expect failure

//!                           5) 1.4.1.3.5, Derive, expect failure

//!                           6) 1.4.1.3.6, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0010-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0010-002

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0010-003

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0010-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0010-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0010-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0010





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0011

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0011

//! @SYMTestCaseDesc          1.4.1.5. Test keys with decrypt usages

//! @SYMTestActions           1) 1.4.1.5.1, Add key

//!                           2) 1.4.1.5.2, Check info

//!                           3) 1.4.1.5.3, Sign, expect failure

//!                           4) 1.4.1.5.4, Decrypt

//!                           5) 1.4.1.5.5, Derive, expect failure

//!                           6) 1.4.1.5.6, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0011-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0011-002

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0011-003

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0011-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0011-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0011-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0011





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0012

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0012

//! @SYMTestCaseDesc          1.4.1.8. Test keys with unwrap usage

//! @SYMTestActions           1) 1.4.1.8.1, Add key

//!                           2) 1.4.1.8.2, Check info

//!                           3) 1.4.1.8.3, Sign, expect failure

//!                           4) 1.4.1.8.4, Decrypt

//!                           5) 1.4.1.8.5, Derive, expect failure

//!                           6) 1.4.1.8.6, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0012-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0012-002

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0012-003

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0012-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0012-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0012-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0012





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0013

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0013

//! @SYMTestCaseDesc          1.4.1.9. Test DSA keys with sign usage only

//! @SYMTestActions           1) 1.4.1.9.1, Add key

//!                           2) 1.4.1.9.2, Check info

//!                           3) 1.4.1.9.3, Sign, expect success

//!                           4) 1.4.1.9.4, Decrypt, expect failure

//!                           5) 1.4.1.9.5, Derive, expect failure

//!                           6) 1.4.1.9.6, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0013-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0013-002

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0013-003

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0013-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0013-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0013-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0013





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0014

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0014

//! @SYMTestCaseDesc          1.4.1.10. Test DSA keys with signRecover usage only

//! @SYMTestActions           1) 1.4.1.10.1, Add key

//!                           2) 1.4.1.10.2, Check info

//!                           3) 1.4.1.10.3, Sign, expect success

//!                           4) 1.4.1.10.4, Decrypt, expect failure

//!                           5) 1.4.1.10.5, Derive, expect failure

//!                           6) 1.4.1.10.6, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0014-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0014-002

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0014-003

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0014-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0014-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0014-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0014





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0015

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0015

//! @SYMTestCaseDesc          1.4.1.12. Test keys with derive usage

//! @SYMTestActions           1) 1.4.1.12.1, Add key

//!                           2) 1.4.1.12.2, Check info

//!                           3) 1.4.1.12.3, Sign, expect failure

//!                           4) 1.4.1.12.4, Decrypt, expect failure

//!                           5) 1.4.1.12.5, Derive, expect failure

//!                           6) 1.4.1.12.6, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0015-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0015-002

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0015-003

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0015-004

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0015-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0015-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0015





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0016

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0016

//! @SYMTestCaseDesc          1.4.1.16. Test RSA keys with NR usage

//! @SYMTestActions           1) 1.4.1.16.1, Add key

//!                           2) 1.4.1.16.3, Check info

//!                           3) 1.4.1.16.4, Sign, expect failure

//!                           4) 1.4.1.16.5, Decrypt, expect failure

//!                           5) 1.4.1.16.6, Derive, expect failure

//!                           6) 1.4.1.16.7, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0016-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0016-002

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0016-003

RUN_TEST_STEP !Error=-11007   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0016-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0016-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0016-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0016





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0017

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0017

//! @SYMTestCaseDesc          1.4.1.17. Test RSA keys with NR usage

//! @SYMTestActions           1) 1.4.1.17.1, Add key

//!                           2) 1.4.1.17.3, Check info

//!                           3) 1.4.1.17.4, Sign, expect failure

//!                           4) 1.4.1.17.5, Decrypt, expect failure

//!                           5) 1.4.1.17.6, Derive, expect failure

//!                           6) 1.4.1.17.7, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0017-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0017-002

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0017-003

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0017-004

RUN_TEST_STEP !Error=-11006   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0017-005

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0017-006

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0017





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0018

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0018

//! @SYMTestCaseDesc          1.4.2 Test access flags

//!                           

//!                           1.4.2.1 Test RSA key with no access flags specified

//! @SYMTestActions           1) 1.4.2.1.1, Add key with no flags specified

//!                           2) 1.4.2.1.2, Check info

//!                           3) 1.4.2.1.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0018-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0018-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0018-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0018





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0019

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0019

//! @SYMTestCaseDesc          1.4.2.2 Test RSA key with sensitive access flag specified

//! @SYMTestActions           1) 1.4.2.2.1, Add key

//!                           2) 1.4.2.2.2, Check info

//!                           3) 1.4.2.2.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0019-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0019-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0019-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0019





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0020

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0020

//! @SYMTestCaseDesc          1.4.2.3 Test RSA key with extractable access flag specified

//! @SYMTestActions           1) 1.4.2.3.1, Add key

//!                           2) 1.4.2.3.2, Check info

//!                           3) 1.4.2.3.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0020-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0020-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0020-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0020





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0021

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0021

//! @SYMTestCaseDesc          1.4.2.4 Test RSA key with sensitive, extractable access flags specified

//! @SYMTestActions           1) 1.4.2.4.1, Add key

//!                           2) 1.4.2.4.2, Check info

//!                           3) 1.4.2.4.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0021-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0021-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0021-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0021





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0022

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0022

//! @SYMTestCaseDesc          1.4.2.5 Failure tests

//! @SYMTestActions           1) 1.4.2.5.1, Add key, expect failure

//!                           2) 1.4.2.5.2, Add key, expect failure

//!                           3) 1.4.2.5.3, Add key, expect failure

RUN_TEST_STEP !Error=-11010   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0022-001

RUN_TEST_STEP !Error=-11010   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0022-002

RUN_TEST_STEP !Error=-11010   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0022-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0022





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0023

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0023

//! @SYMTestCaseDesc          1.4.3 Test start time and end time

//!                           

//!                           1.4.3.1 Start time and end time not set

//! @SYMTestActions           1) 1.4.3.1.1, Add key with no start date and end date

//!                           2) 1.4.3.1.2, Check info

//!                           3) 1.4.3.1.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0023-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0023-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0023-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0023





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0024

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0024

//! @SYMTestCaseDesc          1.4.3.2 Specify start time only

//! @SYMTestActions           1) 1.4.3.2.1, Add key

//!                           2) 1.4.3.2.2, Check info

//!                           3) 1.4.3.2.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0024-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0024-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0024-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0024





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0025

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0025

//! @SYMTestCaseDesc          1.4.3.3 Specify end time only

//! @SYMTestActions           1) 1.4.3.3.1, Add key

//!                           2) 1.4.3.3.2, Check info

//!                           3) 1.4.3.3.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0025-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0025-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0025-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0025





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0026

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0026

//! @SYMTestCaseDesc          1.4.3.4 Specify start time and end time

//! @SYMTestActions           1) 1.4.3.4.1, Add key

//!                           2) 1.4.3.4.2, Check info

//!                           3) 1.4.3.4.3, Delete it again

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0026-001

RUN_TEST_STEP                 -1    CTestHandler        getkeyinfo             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0026-002

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0026-003

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0026





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0027

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0027

//! @SYMTestCaseDesc          1.4.3.5 Failure tests

//!                           

//!                           1.4.3.5.1 Specify start time and end time the wrong way round

//! @SYMTestActions           1) 1.4.3.5.1, Add key

RUN_TEST_STEP !Error=-11008   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0027-001

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0027





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0028

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0028

//! @SYMTestCaseDesc          1.4.3.5.2 Specify end date in the past

//! @SYMTestActions           1) 1.4.3.5.2, Add key

RUN_TEST_STEP !Error=-11008   -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0028-001

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0028





START_TESTCASE                SEC-FILETOKENS-TKEYSTORE-0029

//! @SYMTestCaseID            SEC-FILETOKENS-TKEYSTORE-0029

//! @SYMTestCaseDesc          1.4.3.6 Test that you can't use expired keys

//! @SYMTestActions           1) 1.4.3.6.1, Set the time

//!                           2) 1.4.3.6.2, Add key

//!                           3) 1.4.3.6.2.1, Set passphrase timeout to "don't cache"

//!                           4) 1.4.3.6.3, Add a key

//!                           5) 1.4.3.6.4, Sign

//!                           6) 1.4.3.6.5, Decrypt

//!                           7) 1.4.3.6.6, Derive

//!                           8) 1.4.3.6.7, Set the time past key's expiry date

//!                           9) 1.4.3.6.8, Sign with a banana, expect failure

//!                           10) 1.4.3.6.9, Decrypt, expect failure

//!                           11) 1.4.3.6.10, Derive, expect failure

//!                           12) 1.4.3.6.11, Delete them

//!                           13) 1.4.4.1 Import a RSA key

//!                           14) 1.4.4.2,Set passphrase timeout to "don't cache"

//!                           15) 1.4.4.3,Open a BIGRSA for decrypt

//!                           16) 1.4.4.4, Sign with a BIGRSA, 20 char text

//!                           17) 1.4.4.5, Sign with a BIGRSA, 32 char text

//!                           18) 1.4.4.6, Sign digest with a BIGRSA

//!                           19) 1.4.4.7 Import a BIG DSA key

//!                           20) 1.4.4.8, Sign with a BIGDSA, 20 char text

//!                           21) 1.4.4.9, Sign with BIGDSA, text too long (21 chars)

//!                           22) 1.4.4.10, Sign digest with BIGDSA

//!                           23) 1.4.4.999, Delete everything

//!                           24) 1.4.999.1,Closing key store

//!                           25) 1.4.999.2, Sleep 5 seconds

//!                           26) 1.4.999.3, Check for server heap error

RUN_TEST_STEP                 -1    CTestHandler        settime                tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-001

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-002

RUN_TEST_STEP                 -1    CTestHandler        settimeout             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-003

RUN_TEST_STEP                 -1    CTestHandler        addkey                 tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-004

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-005

RUN_TEST_STEP                 -1    CTestHandler        decrypt                tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-006

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-007

RUN_TEST_STEP                 -1    CTestHandler        settime                tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-008

RUN_TEST_STEP !Error=-11008   -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-009

RUN_TEST_STEP !Error=-11008   -1    CTestHandler        decrypt                tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-010

RUN_TEST_STEP !Error=-11008   -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-011

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-012

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-013

RUN_TEST_STEP                 -1    CTestHandler        settimeout             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-014

RUN_TEST_STEP                 -1    CTestHandler        open                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-015

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-016

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-017

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-018

RUN_TEST_STEP                 -1    CTestHandler        importkey              tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-019

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-020

RUN_TEST_STEP !Error=-9       -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-021

RUN_TEST_STEP                 -1    CTestHandler        sign                   tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-022

RUN_TEST_STEP                 -1    CTestHandler        deletekeys             tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-023

RUN_TEST_STEP                 -1    CTestHandler        delete              

RUN_TEST_STEP                 -1    CTestHandler        sleep                  tkeystore2.ini   SEC-FILETOKENS-TKEYSTORE-0029-025

RUN_TEST_STEP                 -1    CTestHandler        checkserverheaperror

END_TESTCASE                  SEC-FILETOKENS-TKEYSTORE-0029





