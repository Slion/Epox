[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-1-002]

<actionbody>

	<mode>manager</mode>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-2-001]

<actionbody>

	<keyusage>allusagesbutNR</keyusage>

	<keysize>512</keysize>

	<keylabel>banana</keylabel>

	<keyalgorithm>RSA</keyalgorithm>

	<keyaccesstype>Extractable</keyaccesstype>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-2-005]

<actionbody>

	<keyusage>DSAUsage</keyusage>

	<keysize>512</keysize>

	<keylabel>mango</keylabel>

	<keyalgorithm>DSA</keyalgorithm>

	<keyaccesstype>Extractable</keyaccesstype>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-2-006]

<actionbody>

	<keyusage>Derive</keyusage>

	<keysize>512</keysize>

	<keylabel>tomato</keylabel>

	<keyalgorithm>DH</keyalgorithm>

	<keyaccesstype>Extractable</keyaccesstype>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-2-007]

<actionbody>

	<foundkey>banana</foundkey>

	<foundkey>mango</foundkey>

	<foundkey>tomato</foundkey>

</actionbody>












[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-3-001]

<actionbody>

	<keylabel>banana</keylabel>

</actionbody>

<actionresult>

	<policy>

			<secureid>0x101F7E95</secureid>

		</policy>

</actionresult>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-3-002]

<actionbody>

	<keylabel>banana</keylabel>

</actionbody>

<actionresult>

	<policy>

			<secureid>0x101F7E95</secureid>

		</policy>

</actionresult>






[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-001]

<actionbody>

	<keylabel>banana</keylabel>

	<policy>

	<secureid>0x101FFFFF</secureid>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-002]

<actionbody>

	<keylabel>banana</keylabel>

</actionbody>

<actionresult>

	<policy>

			<secureid>0x101FFFFF</secureid>

			<capability>DRM</capability>

			<capability>ReadUserData</capability>

		</policy>

</actionresult>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-003]

<actionbody>

	<keylabel>mango</keylabel>

	<policy>

	<vendorid>0x70000007</vendorid>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-004]

<actionbody>

	<keylabel>mango</keylabel>

</actionbody>

<actionresult>

	<policy>

			<vendorid>0x70000007</vendorid>

			<capability>DRM</capability>

			<capability>ReadUserData</capability>

		</policy>

</actionresult>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-005]

<actionbody>

	<keylabel>tomato</keylabel>

	<policy>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	<capability>WriteUserData</capability>

	<capability>ReadDeviceData</capability>

	<capability>WriteDeviceData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-006]

<actionbody>

	<keylabel>tomato</keylabel>

</actionbody>

<actionresult>

	<policy>

			<capability>DRM</capability>

			<capability>ReadUserData</capability>

			<capability>WriteUserData</capability>

			<capability>ReadDeviceData</capability>

			<capability>WriteDeviceData</capability>

		</policy>

</actionresult>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-007]

<actionbody>

	<keylabel>banana</keylabel>

	<policy>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	<capability>WriteUserData</capability>

	<capability>NetworkControl</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-008]

<actionbody>

	<keylabel>banana</keylabel>

	<policy>

	<secureid>0x101F7E96</secureid>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	<capability>WriteUserData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-009]

<actionbody>

	<keylabel>banana</keylabel>

	<policy>

	<vendorid>0x70000002</vendorid>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	<capability>WriteUserData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-010]

<actionbody>

	<keylabel>banana</keylabel>

	<policy>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	<capability>WriteUserData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-011]

<actionbody>

	<keylabel>banana</keylabel>

</actionbody>

<actionresult>

	<policy>

			<capability>DRM</capability>

			<capability>ReadUserData</capability>

			<capability>WriteUserData</capability>

		</policy>

</actionresult>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-012]

<actionbody>

	<keylabel>mango</keylabel>

	<policy>

	<secureid>0x101F7E95</secureid>

	<capability>ReadUserData</capability>

	<capability>DRM</capability>

	<capability>ReadDeviceData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-013]

<actionbody>

	<keylabel>mango</keylabel>

</actionbody>

<actionresult>

	<policy>

			<secureid>0x101F7E95</secureid>

			<capability>ReadUserData</capability>

			<capability>DRM</capability>

			<capability>ReadDeviceData</capability>

		</policy>

</actionresult>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-014]

<actionbody>

	<keylabel>tomato</keylabel>

	<policy>

	<vendorid>0x70000001</vendorid>

	<capability>ReadUserData</capability>

	<capability>DRM</capability>

	<capability>WriteDeviceData</capability>

	</policy>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-4-015]

<actionbody>

	<keylabel>tomato</keylabel>

</actionbody>

<actionresult>

	<policy>

			<vendorid>0x70000001</vendorid>

			<capability>ReadUserData</capability>

			<capability>DRM</capability>

			<capability>WriteDeviceData</capability>

		</policy>

</actionresult>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-5-001]

<actionbody>

	<testexe>t_keystore.exe</testexe>

	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<secureid>0x101FFFFF</secureid>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store in manager mode</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>

	<action>

		<actionname>2, Get key info</actionname>

		<actiontype>getkeyinfo</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keyalgorithm>RSA</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keyaccesstype>Local</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Sign</actionname>

		<actiontype>sign</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<open>RSA</open>

			<text>This is text of 20 .</text>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>4, Decrypt</actionname>

		<actiontype>decrypt</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<text>Ook!</text>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</passactions>



	<failactions>

	<action>

		<actionname>2, Get key info</actionname>

		<actiontype>getkeyinfo</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keyalgorithm>RSA</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keyaccesstype>Local</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Sign</actionname>

		<actiontype>sign</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<open>RSA</open>

			<text>This is text of 20 .</text>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>4, Decrypt</actionname>

		<actiontype>decrypt</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<text>Ook!</text>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>

	</failactions>



	<postactions>

	<action>

		<actionname>5, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-5-002]

<actionbody>

	<testexe>t_keystore.exe</testexe>

	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<vendorid>0x70000007</vendorid>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store in manager mode</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>

	<action>

		<actionname>2, Get key info</actionname>

		<actiontype>getkeyinfo</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keyalgorithm>DSA</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keyaccesstype>Local</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Sign</actionname>

		<actiontype>sign</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<open>DSA</open>

			<text>This is text of 20 .</text>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</passactions>



	<failactions>

	<action>

		<actionname>2, Get key info</actionname>

		<actiontype>getkeyinfo</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keyalgorithm>DSA</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keyaccesstype>Local</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Sign</actionname>

		<actiontype>sign</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<open>DSA</open>

			<text>This is text of 20 .</text>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>

	</failactions>



	<postactions>

	<action>

		<actionname>4, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-5-003]

<actionbody>

	<testexe>t_keystore.exe</testexe>

	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	<capability>WriteUserData</capability>

	<capability>ReadDeviceData</capability>

	<capability>WriteDeviceData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store in manager mode</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>

	<action>

		<actionname>2, Get key info</actionname>

		<actiontype>getkeyinfo</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keyalgorithm>DH</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keyaccesstype>Local</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>2, Test derive</actionname>

		<actiontype>derive</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<n>DA9A18547FF03B385CC16508C173A7EF4EB61CB40EF8FEF3B31F145051676166BCDC3FE6B799FC394D08C26385F9413F896E09117E46209D6923602683CEA100924A6EE695281775C619DAA94EA8CB3691B4275B0183F1D39639EBC92995FE645D6C1BC28D409E585549BBD2C5DCDD6C208B04EADD8B7A6D997F72CBAD88390F</n>

			<g>02</g>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</passactions>



	<failactions>

	<action>

		<actionname>2, Get key info</actionname>

		<actiontype>getkeyinfo</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keyalgorithm>DH</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keyaccesstype>Local</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>2, Test derive</actionname>

		<actiontype>derive</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<n>DA9A18547FF03B385CC16508C173A7EF4EB61CB40EF8FEF3B31F145051676166BCDC3FE6B799FC394D08C26385F9413F896E09117E46209D6923602683CEA100924A6EE695281775C619DAA94EA8CB3691B4275B0183F1D39639EBC92995FE645D6C1BC28D409E585549BBD2C5DCDD6C208B04EADD8B7A6D997F72CBAD88390F</n>

			<g>02</g>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>

	</failactions>



	<postactions>

	<action>

		<actionname>3, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-5-004]

<actionbody>

	<testexe>t_keystore.exe</testexe>
	
	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<capability>DRM</capability>

	<capability>ReadUserData</capability>

	<capability>WriteUserData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store in manager mode</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>



	<action>

		<actionname>1, Export</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_banana.der</ExportFile>

			<keyusage>allusagesbutNR</keyusage>

			<keylabel>banana</keylabel>

			<keyalgorithm>RSA</keyalgorithm>

			<encrypted>0</encrypted>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>2, Export encrypted</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_encrypted_banana.der</ExportFile>

			<keyusage>allusagesbutNR</keyusage>

			<keylabel>banana</keylabel>

			<keyalgorithm>RSA</keyalgorithm>

			<encrypted>1</encrypted>

			<passphrase>export clanger</passphrase>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Check use policy</actionname>

		<actiontype>getusepolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<secureid>0x101FFFFF</secureid>

				<capability>DRM</capability>

				<capability>ReadUserData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>4, Set use policy</actionname>

		<actiontype>setusepolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>5, Check use policy</actionname>

		<actiontype>getusepolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>6, Check management policy</actionname>

		<actiontype>getmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>DRM</capability>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>7, Set management policy</actionname>

		<actiontype>setmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>8, Check management policy</actionname>

		<actiontype>getmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>9, Delete key</actionname>

		<actiontype>deletekeys</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<deletecount>1</deletecount>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	</passactions>



	<failactions>



	<action>

		<actionname>1, Export</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_banana.der</ExportFile>

			<keyusage>allusagesbutNR</keyusage>

			<keylabel>banana</keylabel>

			<keyalgorithm>RSA</keyalgorithm>

			<encrypted>0</encrypted>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>2, Export encrypted</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_encrypted_banana.der</ExportFile>

			<keyusage>allusagesbutNR</keyusage>

			<keylabel>banana</keylabel>

			<keyalgorithm>RSA</keyalgorithm>

			<encrypted>1</encrypted>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Set use policy</actionname>

		<actiontype>setusepolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>5, Set management policy</actionname>

		<actiontype>setmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>7, Delete key</actionname>

		<actiontype>deletekeys</actiontype>

		<actionbody>

			<keylabel>banana</keylabel>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	</failactions>



	<postactions>

	<action>

		<actionname>4, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-5-005]

<actionbody>

	<testexe>t_keystore.exe</testexe>

	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<secureid>0x101F7E95</secureid>

	<capability>ReadUserData</capability>

	<capability>DRM</capability>

	<capability>ReadDeviceData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store in manager mode</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>



	<action>

		<actionname>2, Export</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_mango.der</ExportFile>

			<keyusage>DSAUsage</keyusage>

			<keylabel>mango</keylabel>

			<keyalgorithm>DSA</keyalgorithm>

			<encrypted>0</encrypted>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Export encrypted</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_encrypted_mango.der</ExportFile>

			<keyusage>DSAUsage</keyusage>

			<keylabel>mango</keylabel>

			<keyalgorithm>DSA</keyalgorithm>

			<encrypted>1</encrypted>	

			<passphrase>export clanger</passphrase>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>4, Check use policy</actionname>

		<actiontype>getusepolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<vendorid>0x70000007</vendorid>

				<capability>DRM</capability>

				<capability>ReadUserData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>5, Set use policy</actionname>

		<actiontype>setusepolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>6, Check use policy</actionname>

		<actiontype>getusepolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>7, Check management policy</actionname>

		<actiontype>getmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<secureid>0x101F7E95</secureid>

				<capability>ReadUserData</capability>

				<capability>DRM</capability>

				<capability>ReadDeviceData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>8, Set management policy</actionname>

		<actiontype>setmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<policy>

				<capability>DRM</capability>

				<capability>ReadDeviceData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>9, Check management policy</actionname>

		<actiontype>getmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>DRM</capability>

				<capability>ReadDeviceData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>10, Delete key</actionname>

		<actiontype>deletekeys</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<deletecount>1</deletecount>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	</passactions>



	<failactions>



	<action>

		<actionname>2, Export</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_mango.der</ExportFile>

			<keyusage>DSAUsage</keyusage>

			<keylabel>mango</keylabel>

			<keyalgorithm>DSA</keyalgorithm>

			<encrypted>0</encrypted>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Export encrypted</actionname>

		<actiontype>exportkey</actiontype>

		<actionbody>

			<ExportFile>exported_encrypted_mango.der</ExportFile>

			<keyusage>DSAUsage</keyusage>

			<keylabel>mango</keylabel>

			<keyalgorithm>DSA</keyalgorithm>

			<encrypted>1</encrypted>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>4, Set use policy</actionname>

		<actiontype>setusepolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>5, Set management policy</actionname>

		<actiontype>setmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

			<policy>

				<capability>DRM</capability>

				<capability>ReadDeviceData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>6, Delete key</actionname>

		<actiontype>deletekeys</actiontype>

		<actionbody>

			<keylabel>mango</keylabel>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	</failactions>



	<postactions>

	<action>

		<actionname>11, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-5-006]

<actionbody>

	<testexe>t_keystore.exe</testexe>

	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<vendorid>0x70000001</vendorid>

	<capability>ReadUserData</capability>

	<capability>DRM</capability>

	<capability>WriteDeviceData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store in manager mode</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>



	<action>

		<actionname>2, Check use policy</actionname>

		<actiontype>getusepolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>DRM</capability>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

				<capability>ReadDeviceData</capability>

				<capability>WriteDeviceData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Set use policy</actionname>

		<actiontype>setusepolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>4, Check use policy</actionname>

		<actiontype>getusepolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>5, Check management policy</actionname>

		<actiontype>getmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<vendorid>0x70000001</vendorid>

				<capability>ReadUserData</capability>

				<capability>DRM</capability>

				<capability>WriteDeviceData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>6, Set management policy</actionname>

		<actiontype>setmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<policy>

				<capability>DRM</capability>

				<capability>WriteDeviceData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>7, Check management policy</actionname>

		<actiontype>getmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

		</actionbody>

		<actionresult>

			<policy>

				<capability>DRM</capability>

				<capability>WriteDeviceData</capability>

			</policy>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>8, Delete key</actionname>

		<actiontype>deletekeys</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<deletecount>1</deletecount>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	</passactions>



	<failactions>



	<action>

		<actionname>2, Set use policy</actionname>

		<actiontype>setusepolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<policy>

				<capability>ReadUserData</capability>

				<capability>WriteUserData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Set management policy</actionname>

		<actiontype>setmanagementpolicy</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

			<policy>

				<capability>DRM</capability>

				<capability>WriteDeviceData</capability>

			</policy>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>4, Delete key</actionname>

		<actiontype>deletekeys</actiontype>

		<actionbody>

			<keylabel>tomato</keylabel>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	</failactions>



	<postactions>

	<action>

		<actionname>9, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>




[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-6-001]

<actionbody>

	<testexe>t_keystore.exe</testexe>

	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<capability>WriteUserData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>

	<action>

		<actionname>2, Create key</actionname>

		<actiontype>addkey</actiontype>

		<actionbody>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keylabel>raspberry</keylabel>

			<keyalgorithm>RSA</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keystore>0</keystore>


		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Import key</actionname>

		<actiontype>importkey</actiontype>

		<actionbody>

			<ImportData>pkcs8rsa.001</ImportData>

			<keyusage>allusagesbutNR</keyusage>

			<keylabel>blueberry</keylabel>

			<keyaccesstype>Extractable</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</passactions>



	<failactions>

	<action>

		<actionname>2, Create key</actionname>

		<actiontype>addkey</actiontype>

		<actionbody>

			<keyusage>allusagesbutNR</keyusage>

			<keysize>512</keysize>

			<keylabel>raspberry</keylabel>

			<keyalgorithm>RSA</keyalgorithm>

			<keyaccesstype>Extractable</keyaccesstype>

			<keystore>0</keystore>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>



	<action>

		<actionname>3, Import key</actionname>

		<actiontype>importkey</actiontype>

		<actionbody>

			<ImportData>pkcs8rsa.001</ImportData>

			<keyusage>allusagesbutNR</keyusage>

			<keylabel>blueberry</keylabel>

			<keyaccesstype>Extractable</keyaccesstype>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>

	</failactions>



	<postactions>

	<action>

		<actionname>5, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-6-002]

<actionbody>

	<testexe>t_keystore.exe</testexe>

	<excludedcapabilities>

	<capability>TCB</capability>

	</excludedcapabilities>

	<policy>

	<capability>ReadUserData</capability>

	</policy>



	<preactions>

	<action>

		<actionname>1, Open key store</actionname>

		<actiontype>init</actiontype>

		<actionbody>

			<mode>manager</mode>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</preactions>



	<passactions>

	<action>

		<actionname>2, List keys</actionname>

		<actiontype>listkeys</actiontype>

		<actionbody>

			<foundkey>raspberry</foundkey>

			<foundkey>blueberry</foundkey>

		</actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</passactions>



	<failactions>

	<action>

		<actionname>2, List keys</actionname>

		<actiontype>listkeys</actiontype>

		<actionbody>

		</actionbody>

		<actionresult>

			<return>KErrPermissionDenied</return>

		</actionresult>

	</action>

	</failactions>



	<postactions>

	<action>

		<actionname>4, Close key store</actionname>

		<actiontype>delete</actiontype>

		<actionbody></actionbody>

		<actionresult>

			<return>KErrNone</return>

		</actionresult>

	</action>

	</postactions>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-7-001]

<actionbody>

	<foundkey>raspberry</foundkey>

	<foundkey>blueberry</foundkey>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-7-002]

<actionbody>

	<deletecount>2</deletecount>

</actionbody>



[SEC-FILETOKENS-AUTHOBJECTS_V2_USEAUTH-7-004]

<actionbody>

	<seconds>5</seconds>

</actionbody>



